#!/usr/bin/env ruby
require "optparse"
$LOAD_PATH << File.join(File.dirname(__FILE__), '..', 'lib')
require "parallel_split_test"

parser = OptionParser.new do |opts|
  opts.banner = <<BANNER
Split a big test file into multiple chunks and run them in parallel, giving ENV['TEST_ENV_NUMBER'] ('', '2', '3', ...)

Usage:
    parallel_split_test test/baz/xxx_text.rb

Options are:
BANNER
  opts.on("-v", "--version", "Show Version"){ require 'parallel_split_test/version'; puts ParallelSplitTest::VERSION; exit}
  opts.on("-h", "--help", "Show this.") { puts opts; exit }
end

parser.parse!

if ARGV.empty?
  puts parser
  exit
end

require "rspec"
require "parallel"

require 'parallel_split_test/runner'
ParallelSplitTest::Runner.run(ARGV)